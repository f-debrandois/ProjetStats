---
title: "Projet d'étude de Statistiques"
author: "Maxime Baba, Alexandre Demarquet, Félix de Brandois, Tristan Gay"
institute : "INSA Toulouse / IMT"
date: "`r Sys.Date()`"
output: 
  pdf_document :
    toc : TRUE
    toc_depth : 2
    number_section : TRUE
header-includes:
   - \usepackage{dsfont}
   - \usepackage{color}
   - \newcommand{\1}{\mathds{1}}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)


library(reticulate)
library(ggplot2)
library(corrplot)
library(FactoMineR)
library(factoextra)
library(gridExtra)

data = read.csv("Data-projetmodIA-2324.csv")
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}

summary(data)
data[1,]
```

```{r}
boxplot(data$nox_kg)
boxplot(data$nox_kg[1:164])
boxplot(data$so2_kg)
boxplot(data$pm10_kg)
boxplot(data$pm25_kg)
boxplot(data$co_kg)
boxplot(data$c6h6_kg)
boxplot(data$nh3_kg)
boxplot(data$ges_teqco2)
boxplot(data$ch4_t)
boxplot(data$co2_t)
boxplot(data$n2o_t)
```

```{r}
data2019= data[1:164,]
g1 = ggplot(data2019, aes(x = TypeEPCI, y = nox_kg)) + geom_boxplot()
g2 = ggplot(data2019, aes(x = TypeEPCI, y = so2_kg)) + geom_boxplot()
g3 = ggplot(data2019, aes(x = TypeEPCI, y = pm10_kg)) + geom_boxplot()
g4 = ggplot(data2019, aes(x = TypeEPCI, y = pm25_kg)) + geom_boxplot()
g5 = ggplot(data2019, aes(x = TypeEPCI, y = co_kg)) + geom_boxplot()
g6 = ggplot(data2019, aes(x = TypeEPCI, y = c6h6_kg)) + geom_boxplot()
g7 = ggplot(data2019, aes(x = TypeEPCI, y = ges_teqco2)) + geom_boxplot()
g8 = ggplot(data2019, aes(x = TypeEPCI, y = ch4_t)) + geom_boxplot()
g9 = ggplot(data2019, aes(x = TypeEPCI, y = co2_t)) + geom_boxplot()
g10 = ggplot(data2019, aes(x = TypeEPCI, y = n2o_t)) + geom_boxplot()
g11 = ggplot(data2019, aes(x = TypeEPCI, y = nh3_kg)) + geom_boxplot()
g12 = ggplot(data2019, aes(x = TypeEPCI)) + geom_bar()
grid.arrange(g1, g2, g3, g4, g5, g6, g11, g7, g8, g9, g10, g12, ncol = 3)

```

```{r}
g1= ggplot(data = data) + geom_histogram(aes(x = nox_kg))
g2= ggplot(data = data) + geom_histogram(aes(x = so2_kg))
g3= ggplot(data = data) + geom_histogram(aes(x = pm10_kg))
g4= ggplot(data = data) + geom_histogram(aes(x = pm25_kg))
g5= ggplot(data = data) + geom_histogram(aes(x = co_kg))
g6= ggplot(data = data) + geom_histogram(aes(x = c6h6_kg))
g7= ggplot(data = data) + geom_histogram(aes(x = ges_teqco2))
g8= ggplot(data = data) + geom_histogram(aes(x = ch4_t))
g9= ggplot(data = data) + geom_histogram(aes(x = co2_t))
g10= ggplot(data = data) + geom_histogram(aes(x = n2o_t))
g11= ggplot(data = data) + geom_histogram(aes(x = nh3_kg))
grid.arrange(g1, g2, g3, g4, g5, g6, g11, g7, g8, g9, g10, ncol = 3)

```


```{r}

g1= ggplot(data = data) + geom_histogram(aes(x = scale(nox_kg)))
g2= ggplot(data = data) + geom_histogram(aes(x = scale(so2_kg)))
g3= ggplot(data = data) + geom_histogram(aes(x = scale(pm10_kg)))
g4= ggplot(data = data) + geom_histogram(aes(x = scale(pm25_kg)))
g5= ggplot(data = data) + geom_histogram(aes(x = scale(co_kg)))
g6= ggplot(data = data) + geom_histogram(aes(x = scale(c6h6_kg)))
g7= ggplot(data = data) + geom_histogram(aes(x = scale(ges_teqco2)))
g8= ggplot(data = data) + geom_histogram(aes(x = scale(ch4_t)))
g9= ggplot(data = data) + geom_histogram(aes(x = scale(co2_t)))
g10= ggplot(data = data) + geom_histogram(aes(x = scale(n2o_t)))
g11= ggplot(data = data) + geom_histogram(aes(x = scale(nh3_kg)))
grid.arrange(g1, g2, g3, g4, g5, g6, g11, g7, g8, g9, g10, ncol = 3)
```

```{r}
g1= ggplot(data = data) + geom_histogram(aes(x=scale(log(nox_kg))))
g2= ggplot(data = data) + geom_histogram(aes(x = scale(log(so2_kg))))
g3= ggplot(data = data) + geom_histogram(aes(x = scale(log(pm10_kg))))
g4= ggplot(data = data) + geom_histogram(aes(x = scale(log(pm25_kg))))
g5= ggplot(data = data) + geom_histogram(aes(x = scale(log(co_kg))))
g6= ggplot(data = data) + geom_histogram(aes(x = scale(log(c6h6_kg))))
g7= ggplot(data = data) + geom_histogram(aes(x = scale(log(ges_teqco2))))
g8= ggplot(data = data) + geom_histogram(aes(x = scale(log(ch4_t))))
g9= ggplot(data = data) + geom_histogram(aes(x = scale(log(co2_t))))
g10= ggplot(data = data) + geom_histogram(aes(x = scale(log(n2o_t))))
g11= ggplot(data = data) + geom_histogram(aes(x = scale(log(nh3_kg))))
grid.arrange(g1, g2, g3, g4, g5, g6, g11, g7, g8, g9, g10, ncol = 3)
```
```{r}
dlog=data[4:15]
data_quant=data[4:14]
data_quant=scale(log(data_quant))
dlog[1:11]=data_quant
  
library("MASS")
library("Matrix")


lda_data <- lda(TypeEPCI ~. ,data=dlog)

D1 <- lda_data$scaling[,1] # vecteur 1

D2 <- lda_data$scaling[,2] # vecteur 2

# Calcul de projeté des individus sur D1 et D2

x <- as.matrix(dlog[,-12])%*%as.matrix(cbind(D1,D2))



color <- dlog$TypeEPCI ;color[color=="CC"] <- "black";

color[color=="CA"] <- "red";color[color=="CU"] <- "green"; color[color=="Metropole"] <- "blue"


plot(x,col=color,pch=20)
#plot(xy,col=color,pch=16 )
```


```{r}


numeric_data <- as.matrix(data_quant)
# Calculer la matrice de covariance
cov_matrix <- cov(numeric_data)

# Calculer la décomposition spectrale de la matrice de covariance
spectral_decomposition <- eigen(cov_matrix)

# Calculer la matrice à la puissance -1/2
inv_sqrt_cov_matrix <- spectral_decomposition$vectors %*% diag(1/sqrt(spectral_decomposition$values)) %*% t(spectral_decomposition$vectors)

# Appliquer la transformation: Cov^-1/2 * x
transformed_data <-  numeric_data%*% inv_sqrt_cov_matrix

data_quant=as.data.frame(transformed_data)


dlog[1:11]=data_quant

lda_data <- lda(TypeEPCI ~. ,data=dlog)

D1 <- lda_data$scaling[,1] # vecteur 1

D2 <- lda_data$scaling[,2] # vecteur 2

# Calcul de projeté des individus sur D1 et D2

xy <- as.matrix(dlog[,-12])%*%as.matrix(cbind(D1,D2))
plot(xy,col=color,pch=20)

```